<!DOCTYPE html>
<html>
<head>
  <title>
      Go
  </title>
  <link rel="stylesheet" href="../application.css">

<meta name="Description" content="JS">
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
</head>

<body id="com">

<div id="not-footer">
  <div id="header">
    <div class="clearfix">
      <h1 class="site-logo"></h1>
    </div>
  </div>

  <div id="content-wrapper">
    <div class="site">
      <div class="content-header small">
        <h6 class="breadcrumbs">
          Go
        </h6>
        <div class="search-form small right">
        </div>
      </div>
      <div class="article js-hide-during-search">
        <h2>Go</h2>
        <div id="article-platform-nav">
  <ul>
    <li class="platform-mac">
      <a href="#platform-mac" data-platform="mac">
        mac
      </a>
    </li>
    <li class="platform-windows">
      <a href="#platform-windows" data-platform="windows">
        windows
      </a>
    </li>
    <li class="platform-linux">
      <a href="#platform-linux" data-platform="linux">
        linux
      </a>
    </li>
    <li class="platform-all">
      <a href="#platform-all" data-platform="all">
        all
      </a>
    </li>
  </ul>
</div>


        <div class="article-body content-body wikistyle markdown-format">
          <div class='intro'>

          </div>

          <div class="intro">

<p>Random Go notes...</p>

</div>

<h3>Functional programming</h3>
<p>
Comparison of a functional programming example:<br>
Integration by rectangle area (and using for this example a linear function):<br><br>

Javascript:
<pre class="code">
let integrate = (f, a, b) => {
    const n = 10;
    let w = (b-a) / n;
    let sum = 0.0;
    for (let i = 1; i <= n; i++) {
        let xi = a + (i-1) * w;
        sum += w * f(xi);
    }
    return sum;
}

area = integrate(x => x, 0, 1);
console.log(area);
</pre>

Java (notice the weird import and the first strange parameter to the integrate method):
<pre class="code">
import java.util.function.DoubleFunction;

class Integrate {

    static double integrate(DoubleFunction&lt;Double&gt; f, double a, double b) {
        int n = 10;
        double sum = 0;
        double w = (b-a) / n;
        for (int i = 1; i <= n; i++) {
            double xi = a + (i-1) * w;
            sum += w * f.apply(xi);
        }
        return sum;
    }

    public static void main(String[] args) {
        double area = integrate(x -> x, 0, 1);
        System.out.println(area);
    }

}
</pre>

Go:
<pre class="code">
package main

import "fmt"

func integrate(f func(float64) float64, a float64, b float64) (sum float64) {
    n := 10
    w := (b-a) / float64(n)
    for i := 1; i <= n; i++ {
        xi := a + float64(i-1) * w
        sum += w * f(xi);
    }
    return sum
}

func main() {
    area := integrate(func(x float64) float64 { return x } , 0, 1)
    fmt.Println(area)
}
</pre>

<h3>JSON parsing</h3>
<p>
Go is a typed language. Still supporting a struct within a struct makes it very easy to map a struct to a JSON object. Also notice how the Go implemetation of a map of integers has a default value of zero, so the test for nil is not needed/wanted. The corresponding Java implementation would have been much longer...<br><br>

Javascript:
<pre class="code">
const fs = require('fs');

fs.readFile('hospitals.json', 'utf8', (err, contents) => {
    let hospitals = JSON.parse(contents);
    let data = hospitals.features;
    let r = data.reduce((acc, x) => {
        acc[x.properties.STATE] = acc[x.properties.STATE] == undefined ? 1 : acc[x.properties.STATE] + 1
        return acc;
    }, {});
    var states = [];
    for (k in r) {
        var v = {name: k, hospitals: r[k]};
        states.push(v);
    }
    console.log(JSON.stringify(states));
});
</pre>

Go:
<pre class="code">
package main

import (
    "fmt"
    "io/ioutil"
    "encoding/json"
)

type Hospital struct {
    Type    string
    Features []struct {
        Type string
        Properties struct {
            Name string
            State string
        }
    }
}

type State struct {
    Name string
    Hospitals int
}

func load() {
    data, _ := ioutil.ReadFile("hospitals.json")
    var hospitals Hospital
    m := make(map[string]int)
    json.Unmarshal(data, &hospitals)
    for _, v := range hospitals.Features {
        m[v.Properties.State]++;
    }
    var states []State
    for k, v := range m {
        states = append(states, State{k, v})
    }
    data, _ = json.Marshal(states);
    fmt.Printf("%s\n", data)
}

func main() {
    load()
}
</pre>

<div class="fullscreen-overlay"></div>
</body>
</html>

